Criei um guia completo de testes no Postman que cobre todos os cen√°rios poss√≠veis do sistema de artigos!
üéØ O que o guia inclui:
üìã 6 Cen√°rios Principais

Cria√ß√£o de Artigos - casos v√°lidos e todas as valida√ß√µes
Visualiza√ß√£o - artigos p√∫blicos, privados, por ID/slug
Modera√ß√£o - aprova√ß√£o, rejei√ß√£o, permiss√µes
Busca e Filtros - pesquisa avan√ßada, tags, estat√≠sticas
Casos Edge - valida√ß√µes, pagina√ß√£o, incremento de views
Fluxos Completos - end-to-end do processo de modera√ß√£o

üîß Recursos Inclu√≠dos

‚úÖ Vari√°veis de ambiente para reutiliza√ß√£o
‚úÖ Headers completos para cada request
‚úÖ Bodies JSON realistas com exemplos pr√°ticos
‚úÖ C√≥digos de status esperados
‚úÖ Scripts autom√°ticos para valida√ß√£o
‚úÖ Checklist completo de funcionalidades
‚úÖ Troubleshooting para problemas comuns

üìä Cobertura de Testes

17 endpoints diferentes testados
30+ cen√°rios de teste espec√≠ficos
Todos os c√≥digos de erro cobertos
Valida√ß√µes de permiss√£o por role
Edge cases e situa√ß√µes limite
Fluxos end-to-end completos

üöÄ Como usar:

Configure as vari√°veis de ambiente no Postman
Obtenha os tokens JWT para cada tipo de usu√°rio
Execute os testes na ordem sugerida
Use os scripts para automatizar valida√ß√µes
Siga o checklist para cobertura completa

O guia √© auto-suficiente e voc√™ pode testar todo o sistema de artigos desde a cria√ß√£o at√© a publica√ß√£o, incluindo todos os casos de erro e valida√ß√µes! üéâ

# üìù Guia de Testes Postman - Sistema de Artigos

## üöÄ Configura√ß√£o Inicial

### Vari√°veis de Ambiente
Configure essas vari√°veis no Postman:

```
BASE_URL = http://localhost:3001
USER_TOKEN = (token JWT do usu√°rio comum)
ADMIN_TOKEN = (token JWT do admin)
MODERATOR_TOKEN = (token JWT do moderador)
ARTICLE_ID = (ser√° preenchido durante os testes)
ARTICLE_SLUG = (ser√° preenchido durante os testes)
```

### Pr√©-requisitos
1. **Usu√°rios criados e logados:**
   - 1 usu√°rio comum
   - 1 moderador (role: MODERATOR)
   - 1 admin (role: ADMIN)
2. **Tokens obtidos** atrav√©s do endpoint de login
3. **Banco limpo** para testes consistentes

---

## üìã **CEN√ÅRIO 1: Cria√ß√£o de Artigos**

### 1.1 ‚úÖ Criar Artigo V√°lido (Usu√°rio Comum)

**POST** `{{BASE_URL}}/articles`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
Content-Type: application/json
```

**Body:**
```json
{
  "titulo": "Como implementar Clean Architecture com NestJS",
  "descricao": "Um guia completo sobre como estruturar projetos Node.js seguindo os princ√≠pios da arquitetura limpa",
  "conteudo": "# Introdu√ß√£o\n\nA Clean Architecture √© um padr√£o arquitetural criado por Robert C. Martin que visa separar as responsabilidades em camadas bem definidas. Neste artigo, vamos aprender como implementar esse padr√£o em projetos NestJS.\n\n## O que √© Clean Architecture?\n\nA Clean Architecture √© baseada em algumas regras fundamentais:\n\n1. **Independ√™ncia de frameworks**: A arquitetura n√£o deve depender de libraries externas\n2. **Testabilidade**: As regras de neg√≥cio podem ser testadas sem UI, banco de dados, web server, etc\n3. **Independ√™ncia da UI**: A UI pode mudar facilmente sem alterar o resto do sistema\n4. **Independ√™ncia do banco de dados**: Voc√™ pode trocar Oracle ou SQL Server por MongoDB, BigTable, CouchDB ou qualquer outro\n\n## Estrutura de Pastas\n\n```\nsrc/\n‚îú‚îÄ‚îÄ domain/          # Regras de neg√≥cio\n‚îÇ   ‚îú‚îÄ‚îÄ entities/\n‚îÇ   ‚îú‚îÄ‚îÄ repositories/\n‚îÇ   ‚îî‚îÄ‚îÄ usecases/\n‚îú‚îÄ‚îÄ application/     # Casos de uso da aplica√ß√£o\n‚îú‚îÄ‚îÄ infrastructure/  # Implementa√ß√µes externas\n‚îÇ   ‚îú‚îÄ‚îÄ database/\n‚îÇ   ‚îú‚îÄ‚îÄ web/\n‚îÇ   ‚îî‚îÄ‚îÄ services/\n‚îî‚îÄ‚îÄ main.ts         # Ponto de entrada\n```\n\n## Implementa√ß√£o no NestJS\n\nVamos ver como criar cada camada:\n\n### Domain Layer\n\nA camada de dom√≠nio cont√©m as entidades e regras de neg√≥cio:\n\n```typescript\n// src/domain/entities/user.entity.ts\nexport class User {\n  constructor(\n    private readonly id: string,\n    private readonly name: string,\n    private readonly email: string\n  ) {}\n\n  public getName(): string {\n    return this.name;\n  }\n\n  public getEmail(): string {\n    return this.email;\n  }\n\n  public isValidEmail(): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(this.email);\n  }\n}\n```\n\nEste artigo demonstra como implementar Clean Architecture de forma pr√°tica e eficiente.",
  "categoria": "BACKEND",
  "tags": ["nestjs", "clean-architecture", "typescript", "backend", "node.js"],
  "images": [
    {
      "filename": "clean-architecture-diagram.png",
      "type": "PNG",
      "base64": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
      "alt": "Diagrama da Clean Architecture",
      "order": 0,
      "isMain": true
    },
    {
      "filename": "nestjs-structure.png", 
      "type": "PNG",
      "url": "https://example.com/nestjs-structure.png",
      "alt": "Estrutura de pastas do NestJS",
      "order": 1,
      "isMain": false
    }
  ]
}
```

**Resultado Esperado:** `201 Created`
```json
{
  "id": "uuid-do-artigo",
  "titulo": "Como implementar Clean Architecture com NestJS",
  "slug": "como-implementar-clean-architecture-com-nestjs",
  "status": "PENDING",
  "createdAt": "2024-01-15T10:00:00Z",
  "message": "Artigo criado com sucesso! Aguarde a aprova√ß√£o de um moderador."
}
```

### 1.2 ‚ùå Criar Artigo com T√≠tulo Muito Curto

**POST** `{{BASE_URL}}/articles`

**Headers:** (mesmo do anterior)

**Body:**
```json
{
  "titulo": "Hi",
  "descricao": "Descri√ß√£o muito pequena tamb√©m",
  "conteudo": "Conte√∫do pequeno",
  "categoria": "BACKEND",
  "tags": ["test"]
}
```

**Resultado Esperado:** `400 Bad Request`

### 1.3 ‚ùå Criar Artigo sem Autentica√ß√£o

**POST** `{{BASE_URL}}/articles`

**Headers:**
```
Content-Type: application/json
```

**Body:** (qualquer artigo v√°lido)

**Resultado Esperado:** `401 Unauthorized`

### 1.4 ‚ùå Criar 6¬∫ Artigo (Limite Excedido)

**Pr√©-requisito:** Usu√°rio j√° tem 5 artigos ativos

**POST** `{{BASE_URL}}/articles`

**Headers:** (com token v√°lido)

**Body:** (artigo v√°lido)

**Resultado Esperado:** `400 Bad Request`
```json
{
  "statusCode": 400,
  "timestamp": "2024-01-15T10:00:00Z",
  "message": "Voc√™ atingiu o limite m√°ximo de 5 artigos. Delete ou arquive artigos existentes antes de criar novos."
}
```

### 1.5 ‚ùå Criar Artigo com Muitas Imagens

**POST** `{{BASE_URL}}/articles`

**Body:**
```json
{
  "titulo": "Artigo com muitas imagens",
  "descricao": "Testando limite de imagens",
  "conteudo": "Conte√∫do v√°lido com mais de 100 caracteres para passar na valida√ß√£o do sistema de artigos",
  "categoria": "FRONTEND",
  "tags": ["test"],
  "images": [
    {"filename": "img1.png", "type": "PNG", "order": 0, "isMain": true},
    {"filename": "img2.png", "type": "PNG", "order": 1, "isMain": false},
    {"filename": "img3.png", "type": "PNG", "order": 2, "isMain": false},
    {"filename": "img4.png", "type": "PNG", "order": 3, "isMain": false},
    {"filename": "img5.png", "type": "PNG", "order": 4, "isMain": false},
    {"filename": "img6.png", "type": "PNG", "order": 5, "isMain": false}
  ]
}
```

**Resultado Esperado:** `400 Bad Request`

---

## üëÄ **CEN√ÅRIO 2: Visualiza√ß√£o de Artigos**

### 2.1 ‚úÖ Listar Artigos P√∫blicos (Sem Autentica√ß√£o)

**GET** `{{BASE_URL}}/articles`

**Headers:** Nenhum necess√°rio

**Resultado Esperado:** `200 OK`

### 2.2 ‚úÖ Listar Artigos com Filtros

**GET** `{{BASE_URL}}/articles?categoria=BACKEND&tags=nestjs,typescript&page=1&limit=10&sortBy=visualizacoes&sortOrder=desc`

### 2.3 ‚úÖ Ver Artigo por ID (P√∫blico)

**GET** `{{BASE_URL}}/articles/{{ARTICLE_ID}}`

**Headers:** Nenhum necess√°rio

### 2.4 ‚úÖ Ver Artigo por Slug

**GET** `{{BASE_URL}}/articles/slug/como-implementar-clean-architecture-com-nestjs`

### 2.5 ‚úÖ Ver Artigo Pr√≥prio (PENDING)

**GET** `{{BASE_URL}}/articles/{{ARTICLE_ID}}`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
```

### 2.6 ‚ùå Ver Artigo Pendente de Outro Usu√°rio

**GET** `{{BASE_URL}}/articles/{{OTHER_USER_PENDING_ARTICLE_ID}}`

**Resultado Esperado:** `403 Forbidden`

### 2.7 ‚úÖ Meus Artigos

**GET** `{{BASE_URL}}/articles/my-articles?page=1&limit=10`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
```

### 2.8 ‚úÖ Meus Artigos Filtrados por Status

**GET** `{{BASE_URL}}/articles/my-articles?status=PENDING`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
```

---

## üõ°Ô∏è **CEN√ÅRIO 3: Modera√ß√£o de Artigos**

### 3.1 ‚úÖ Ver Artigos Pendentes (Moderador)

**GET** `{{BASE_URL}}/articles/pending-moderation`

**Headers:**
```
Authorization: Bearer {{MODERATOR_TOKEN}}
```

**Resultado Esperado:** `200 OK`

### 3.2 ‚úÖ Aprovar Artigo (Moderador)

**POST** `{{BASE_URL}}/articles/{{ARTICLE_ID}}/moderate`

**Headers:**
```
Authorization: Bearer {{MODERATOR_TOKEN}}
Content-Type: application/json
```

**Body:**
```json
{
  "action": "approve"
}
```

**Resultado Esperado:** `200 OK`
```json
{
  "success": true,
  "message": "Artigo aprovado com sucesso!",
  "article": {
    "id": "uuid",
    "titulo": "Como implementar Clean Architecture com NestJS",
    "status": "APPROVED",
    "author": {
      "id": "user-id",
      "name": "Nome do Autor",
      "email": "autor@email.com"
    }
  },
  "moderator": {
    "id": "moderator-id",
    "name": "Nome do Moderador",
    "email": "moderator@email.com"
  },
  "moderatedAt": "2024-01-15T11:00:00Z"
}
```

### 3.3 ‚úÖ Rejeitar Artigo (Moderador)

**POST** `{{BASE_URL}}/articles/{{ARTICLE_ID}}/moderate`

**Headers:**
```
Authorization: Bearer {{MODERATOR_TOKEN}}
Content-Type: application/json
```

**Body:**
```json
{
  "action": "reject",
  "rejectionReason": "O conte√∫do n√£o segue as diretrizes da comunidade. Por favor, revise as se√ß√µes sobre c√≥digo malicioso e reenvie."
}
```

### 3.4 ‚ùå Rejeitar sem Motivo

**POST** `{{BASE_URL}}/articles/{{ARTICLE_ID}}/moderate`

**Body:**
```json
{
  "action": "reject"
}
```

**Resultado Esperado:** `400 Bad Request`

### 3.5 ‚ùå Moderar Pr√≥prio Artigo

**POST** `{{BASE_URL}}/articles/{{OWN_ARTICLE_ID}}/moderate`

**Headers:**
```
Authorization: Bearer {{MODERATOR_TOKEN}}
```

**Body:**
```json
{
  "action": "approve"
}
```

**Resultado Esperado:** `400 Bad Request`

### 3.6 ‚ùå Usu√°rio Comum Tentando Moderar

**POST** `{{BASE_URL}}/articles/{{ARTICLE_ID}}/moderate`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
```

**Resultado Esperado:** `403 Forbidden`

---

## üîç **CEN√ÅRIO 4: Busca e Filtros**

### 4.1 ‚úÖ Busca por Conte√∫do

**GET** `{{BASE_URL}}/articles/search?q=clean architecture&page=1&limit=20`

### 4.2 ‚úÖ Busca com Filtros

**GET** `{{BASE_URL}}/articles/search?q=nestjs&categoria=BACKEND&tags=typescript`

### 4.3 ‚úÖ Busca Vazia

**GET** `{{BASE_URL}}/articles/search?q=`

**Resultado Esperado:** Lista vazia

### 4.4 ‚úÖ Tags Populares

**GET** `{{BASE_URL}}/articles/tags/popular?limit=10`

### 4.5 ‚úÖ Estat√≠sticas (Admin)

**GET** `{{BASE_URL}}/articles/stats`

**Headers:**
```
Authorization: Bearer {{ADMIN_TOKEN}}
```

**Resultado Esperado:** `200 OK`
```json
{
  "totalArticles": 25,
  "pendingArticles": 3,
  "approvedArticles": 20,
  "rejectedArticles": 2,
  "archivedArticles": 0,
  "totalViews": 1547,
  "averageReadingTime": 8,
  "articlesByCategory": {
    "BACKEND": 12,
    "FRONTEND": 8,
    "MOBILE": 3,
    "DEVOPS": 2
  },
  "topTags": [
    {"tag": "javascript", "count": 15},
    {"tag": "typescript", "count": 12},
    {"tag": "react", "count": 8}
  ]
}
```

### 4.6 ‚ùå Usu√°rio Comum Tentando Ver Stats

**GET** `{{BASE_URL}}/articles/stats`

**Headers:**
```
Authorization: Bearer {{USER_TOKEN}}
```

**Resultado Esperado:** `403 Forbidden`

---

## üß™ **CEN√ÅRIO 5: Casos Edge e Valida√ß√µes**

### 5.1 ‚ùå Artigo com Slug Duplicado

Tente criar dois artigos com t√≠tulos que gerem o mesmo slug:
- "Clean Architecture!!!"
- "Clean Architecture???"

**Resultado Esperado:** Sistema deve gerar slugs √∫nicos automaticamente

### 5.2 ‚úÖ Incremento de Visualiza√ß√µes

1. **GET** `{{BASE_URL}}/articles/{{APPROVED_ARTICLE_ID}}` (sem token)
2. **GET** `{{BASE_URL}}/articles/{{APPROVED_ARTICLE_ID}}` (com token de outro usu√°rio)
3. **GET** `{{BASE_URL}}/articles/{{APPROVED_ARTICLE_ID}}` (com token do pr√≥prio autor)

**Teste:** Verificar se visualiza√ß√µes incrementam corretamente (n√£o deve incrementar para o pr√≥prio autor)

### 5.3 ‚ùå IDs Inv√°lidos

**GET** `{{BASE_URL}}/articles/invalid-uuid`

**Resultado Esperado:** `400 Bad Request`

### 5.4 ‚ùå Artigo N√£o Encontrado

**GET** `{{BASE_URL}}/articles/00000000-0000-0000-0000-000000000000`

**Resultado Esperado:** `404 Not Found`

### 5.5 ‚úÖ Pagina√ß√£o

Teste diferentes valores:
- `?page=1&limit=5`
- `?page=2&limit=5`
- `?page=999&limit=10` (p√°gina inexistente)
- `?page=1&limit=101` (limite m√°ximo)

### 5.6 ‚úÖ Ordena√ß√£o

Teste diferentes ordena√ß√µes:
- `?sortBy=createdAt&sortOrder=desc`
- `?sortBy=visualizacoes&sortOrder=desc`
- `?sortBy=titulo&sortOrder=asc`

---

## üìä **CEN√ÅRIO 6: Fluxo Completo de Modera√ß√£o**

### Fluxo 1: Artigo Aprovado
1. **Usu√°rio cria artigo** ‚Üí Status: PENDING
2. **Moderador lista pendentes** ‚Üí V√™ o artigo
3. **Moderador aprova** ‚Üí Status: APPROVED
4. **Artigo fica p√∫blico** ‚Üí Qualquer um pode ver
5. **Visualiza√ß√µes incrementam** ‚Üí Contador funciona

### Fluxo 2: Artigo Rejeitado e Corrigido
1. **Usu√°rio cria artigo** ‚Üí Status: PENDING
2. **Moderador rejeita com motivo** ‚Üí Status: REJECTED
3. **Usu√°rio v√™ motivo** ‚Üí Em "meus artigos"
4. **Usu√°rio edita artigo** ‚Üí *(implementar depois)*
5. **Moderador aprova nova vers√£o** ‚Üí Status: APPROVED

---

## üîß **Scripts Postman √öteis**

### Script para Salvar Article ID
```javascript
// No teste de cria√ß√£o de artigo, adicionar em "Tests":
if (pm.response.code === 201) {
    const response = pm.response.json();
    pm.environment.set("ARTICLE_ID", response.id);
    pm.environment.set("ARTICLE_SLUG", response.slug);
}
```

### Script para Validar Pagina√ß√£o
```javascript
// Em testes de listagem:
pm.test("Pagination structure is correct", function () {
    const response = pm.response.json();
    pm.expect(response).to.have.property("pagination");
    pm.expect(response.pagination).to.have.all.keys("page", "limit", "total", "totalPages", "hasNext", "hasPrevious");
});
```

### Script para Validar Article Structure
```javascript
pm.test("Article has correct structure", function () {
    const response = pm.response.json();
    const article = response.articles ? response.articles[0] : response;
    
    pm.expect(article).to.have.property("id");
    pm.expect(article).to.have.property("titulo");
    pm.expect(article).to.have.property("slug");
    pm.expect(article).to.have.property("categoria");
    pm.expect(article).to.have.property("tags");
    pm.expect(article.tags).to.be.an("array");
});
```

---

## üìù **Checklist de Testes**

### ‚úÖ Funcionalidades B√°sicas
- [ ] Criar artigo v√°lido
- [ ] Listar artigos p√∫blicos
- [ ] Ver artigo por ID
- [ ] Ver artigo por slug
- [ ] Meus artigos
- [ ] Busca por conte√∫do
- [ ] Tags populares

### ‚úÖ Modera√ß√£o
- [ ] Listar pendentes (MOD/ADMIN)
- [ ] Aprovar artigo (MOD/ADMIN)
- [ ] Rejeitar artigo com motivo (MOD/ADMIN)
- [ ] Estat√≠sticas (ADMIN)

### ‚úÖ Valida√ß√µes
- [ ] Limite de 5 artigos por usu√°rio
- [ ] M√°ximo 5 imagens por artigo
- [ ] Valida√ß√µes de tamanho (t√≠tulo, descri√ß√£o, conte√∫do)
- [ ] Motivo obrigat√≥rio para rejei√ß√£o
- [ ] Permiss√µes corretas por role

### ‚úÖ Edge Cases
- [ ] IDs inv√°lidos
- [ ] Artigos n√£o encontrados
- [ ] Pagina√ß√£o com valores extremos
- [ ] Busca vazia
- [ ] Incremento de visualiza√ß√µes
- [ ] Slugs √∫nicos

---

## üö® **Troubleshooting**

### Erro 401 Unauthorized
- Verificar se token est√° v√°lido
- Verificar formato: `Bearer TOKEN`
- Verificar se usu√°rio existe

### Erro 403 Forbidden
- Verificar roles do usu√°rio
- Verificar se endpoint requer ADMIN/MODERATOR

### Erro 400 Bad Request
- Verificar JSON v√°lido
- Verificar campos obrigat√≥rios
- Verificar valida√ß√µes (tamanhos, formatos)

### Erro 404 Not Found
- Verificar se artigo existe
- Verificar UUID v√°lido
- Verificar se artigo n√£o foi deletado

Este guia cobre todos os cen√°rios principais para testar o sistema de artigos completo! üéØ
